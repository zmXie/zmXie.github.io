(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[42],{

/***/ 601:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/@vuepress/core/node_modules/.cache/vuepress","cacheIdentifier":"18d1decd-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??ref--1-1!./node_modules/@vuepress/markdown-loader??ref--1-2!./blogs/frontEnd/20211115-microApp.md?vue&type=template&id=589590cf&
var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ContentSlotsDistributor',{attrs:{"slot-key":_vm.$parent.slotKey}},[_c('p',[_vm._v("小程序本质是 "),_c('code',[_vm._v("Hybrid App")]),_vm._v("（混合 App），渲染层走的 "),_c('code',[_vm._v("webView")]),_vm._v("，逻辑层走 "),_c('code',[_vm._v("JSCore")]),_vm._v("（"),_c('code',[_vm._v("V8")]),_vm._v(" ：android 内置框架、"),_c('code',[_vm._v("JavascriptCore")]),_vm._v("：iOS 内置框架，App 可以直接使用该框架来运行 JS 代码），两个线程的通信由原生做中转。")]),_vm._v(" "),_c('h3',{attrs:{"id":"架构图"}},[_c('a',{staticClass:"header-anchor",attrs:{"href":"#架构图"}},[_vm._v("#")]),_vm._v(" 架构图")]),_vm._v(" "),_c('p',[_c('img',{attrs:{"src":"https://pic1.zhimg.com/v2-577d754f01920923e08ab03f3e43f5f0_r.jpg","alt":"小程序架构"}})]),_vm._v(" "),_c('ul',[_c('li',[_c('strong',[_vm._v("为什么使用双线程模型")]),_vm._v("：小程序为了体验上更接近原生 App，一个页面对应一个 webview，存储到页面栈中，而 webview 之间是天然隔离的，上下文不共享，所以独立出逻辑层，使整个小程序生命周期中上下文一致，这样，webview 只负责页面渲染，事件处理统一在逻辑线程处理，由微信原生通信，而处理好的数据再由原生传给渲染层更新 UI。")])]),_vm._v(" "),_c('h3',{attrs:{"id":"小程序启动"}},[_c('a',{staticClass:"header-anchor",attrs:{"href":"#小程序启动"}},[_vm._v("#")]),_vm._v(" 小程序启动")]),_vm._v(" "),_c('ul',[_c('li',[_c('strong',[_vm._v("冷启动")]),_vm._v("：如果用户首次打开（届时会先下载小程序包），或小程序销毁后再被打开，此时小程序会重新加载启动，即冷启动。")]),_vm._v(" "),_c('li',[_c('strong',[_vm._v("热启动")]),_vm._v("：如果用户已经打开过某个小程序，30 分钟之内再次打开，不会重新加载，只是从后台切换到前台，即热启动。")])]),_vm._v(" "),_c('h3',{attrs:{"id":"销毁"}},[_c('a',{staticClass:"header-anchor",attrs:{"href":"#销毁"}},[_vm._v("#")]),_vm._v(" 销毁")]),_vm._v(" "),_c('ul',[_c('li',[_vm._v("宿主 App 被杀死时，小程序自然也会被销毁。")]),_vm._v(" "),_c('li',[_vm._v("当小程序进入后台被挂起超过 30 分钟，都没有进入前台，小程序会被销毁。")]),_vm._v(" "),_c('li',[_vm._v("当小程序占用系统资源过高时，会被微信主动销毁。")])]),_vm._v(" "),_c('h3',{attrs:{"id":"更新"}},[_c('a',{staticClass:"header-anchor",attrs:{"href":"#更新"}},[_vm._v("#")]),_vm._v(" 更新")]),_vm._v(" "),_c('ul',[_c('li',[_c('strong',[_vm._v("未启动时更新")]),_vm._v("：微信运行时，会定期检查最近使用的小程序是否有更新，如果有则会下载更新。")]),_vm._v(" "),_c('li',[_c('strong',[_vm._v("启动更新")]),_vm._v("：小程序每次冷启动都会异步检查是否有更新，如果有则会下载，但是此次仍然是旧版本。")])]),_vm._v(" "),_c('h3',{attrs:{"id":"遇到问题"}},[_c('a',{staticClass:"header-anchor",attrs:{"href":"#遇到问题"}},[_vm._v("#")]),_vm._v(" 遇到问题")]),_vm._v(" "),_c('ul',[_c('li',[_c('strong',[_vm._v("问题")]),_vm._v("：同一个长表单在浏览器渲染很快，但是在小程序渲染很慢（iphone12 大概白屏 2-3 秒），很奇怪，小程序基于 webview 渲染，理论上两者的渲染能力是一样的，为什么一个快一个慢？")]),_vm._v(" "),_c('li',[_c('strong',[_vm._v("原因")]),_vm._v("："),_c('strong',[_vm._v("同一时间调用 "),_c('code',[_vm._v("setData")]),_vm._v(" 频率太高且数据太多，导致通信队列阻塞")]),_vm._v("。因为小程序是双线程模型，逻辑层跟渲染层分别在两个不同的线程执行，由微信"),_c('code',[_vm._v("JSBridge")]),_vm._v("来做通信，调用 "),_c('code',[_vm._v("setData")]),_vm._v(" 会通知渲染层更新 UI，所以太频繁就会导致通信队列阻塞，页面渲染不及时，表现上就很卡。")]),_vm._v(" "),_c('li',[_c('strong',[_vm._v("解决方案")]),_vm._v("：用定时器将表单分页加载，每 0.2 秒加载 1 页，分 6 页加载，降低同一时间调用 "),_c('code',[_vm._v("setData")]),_vm._v(" 的频率，保证首页快速加载。")])]),_vm._v(" "),_c('div',{staticClass:"language-js line-numbers-mode"},[_c('pre',{pre:true,attrs:{"class":"language-js"}},[_c('code',[_c('span',{pre:true,attrs:{"class":"token comment"}},[_vm._v("// 分页加载")]),_vm._v("\n"),_c('span',{pre:true,attrs:{"class":"token function"}},[_vm._v("pageLoading")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token parameter"}},[_vm._v("totalPage "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("6")])]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("{")]),_vm._v("\n  "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("return")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("new")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token class-name"}},[_vm._v("Promise")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token parameter"}},[_vm._v("resolve")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=>")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("{")]),_vm._v("\n    "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("let")]),_vm._v(" intervalId "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token function"}},[_vm._v("setInterval")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("=>")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("{")]),_vm._v("\n      "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("this")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("currentPage"),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v("++")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(";")]),_vm._v("\n      "),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("if")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token keyword"}},[_vm._v("this")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(".")]),_vm._v("currentPage "),_c('span',{pre:true,attrs:{"class":"token operator"}},[_vm._v(">=")]),_vm._v(" totalPage"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("{")]),_vm._v("\n        "),_c('span',{pre:true,attrs:{"class":"token function"}},[_vm._v("clearInterval")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_vm._v("intervalId"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(";")]),_vm._v("\n        "),_c('span',{pre:true,attrs:{"class":"token function"}},[_vm._v("resolve")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("(")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_vm._v("\n      "),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("}")]),_vm._v("\n    "),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("}")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(",")]),_vm._v(" "),_c('span',{pre:true,attrs:{"class":"token number"}},[_vm._v("200")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(";")]),_vm._v("\n  "),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("}")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(")")]),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v(";")]),_vm._v("\n"),_c('span',{pre:true,attrs:{"class":"token punctuation"}},[_vm._v("}")]),_vm._v("\n")])]),_vm._v(" "),_c('div',{staticClass:"line-numbers-wrapper"},[_c('span',{staticClass:"line-number"},[_vm._v("1")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("2")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("3")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("4")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("5")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("6")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("7")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("8")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("9")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("10")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("11")]),_c('br'),_c('span',{staticClass:"line-number"},[_vm._v("12")]),_c('br')])])])}
var staticRenderFns = []


// CONCATENATED MODULE: ./blogs/frontEnd/20211115-microApp.md?vue&type=template&id=589590cf&

// EXTERNAL MODULE: ./node_modules/vue-loader/lib/runtime/componentNormalizer.js
var componentNormalizer = __webpack_require__(10);

// CONCATENATED MODULE: ./blogs/frontEnd/20211115-microApp.md

var script = {}


/* normalize component */

var component = Object(componentNormalizer["a" /* default */])(
  script,
  render,
  staticRenderFns,
  false,
  null,
  null,
  null
  
)

/* harmony default export */ var _20211115_microApp = __webpack_exports__["default"] = (component.exports);

/***/ })

}]);